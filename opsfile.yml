version: 3

tasks:

  cli:
    silent: true
    desc: python repl
    cmds:
    - |
      cd $OPS_PWD
      set -a
      source .env
      if {{.__ide}}
      then ~/.ops/miniconda3/bin/ptipython
      else python -m IPython
      fi

  chat:
    desc: ask to the AI (LLama3)
    silent: true
    cmds:
    - |
      args={{._args_}}
      set -- ${args[@]}
      test "$1" = "--" && shift
      python chat.py {{._action_}} "$@"

  notebook:
    desc: notebook    
    dir: $OPS_PWD/notebook
    env: 
      HF_HOME: 
        sh: echo $OPS_PWD/workspace
    cmds:
    - mkdir -p  $OPS_PWD/workspace
    -  ~/.ops/miniconda3/bin/jupyter notebook

  img:
    desc: generate images (SDXL)
    silent: true
    cmds:
    - |
      args={{._args_}}
      set -- ${args[@]}
      test "$1" = "--" && shift
      python scripts/img.py --dir "$OPS_PWD/images" "$@"
